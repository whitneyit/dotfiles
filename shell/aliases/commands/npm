#!/usr/bin/env bash

yarn-exists() {
    if [ ! "$(type -P yarn)" ]; then
        echo 0
    elif [ ! -f "$(type -P yarn)" ]; then
        echo 0
    else
        echo 1
    fi
}

ni() {
    if [ "$(yarn-exists)" == "1" ]; then
        if [ "$#" == "0" ]; then
            echo "$GREY$ yarn install$RESET"
            yarn install
        else
            echo "$GREY$ yarn add "$@"$RESET"
            yarn add "$@"
        fi
    else
        if [ "$#" == "0" ]; then
            echo "$GREY$ npm install$RESET"
            npm install
        else
            echo "$GREY$ npm install --save "$@"$RESET"
            npm install --save "$@"
        fi
    fi
}

nid() {
    if [ "$(yarn-exists)" == "1" ]; then
        echo "$GREY$ yarn add --dev "$@"$RESET"
        yarn add --dev "$@"
    else
        echo "$GREY$ npm install --save-dev "$@"$RESET"
        npm install --save-dev "$@"
    fi
}

nig() {
    if [ "$(yarn-exists)" == "1" ]; then
        echo "$GREY$ yarn global add "$@"$RESET"
        yarn global add "$@"
    else
        echo "$GREY$ npm install --global "$@"$RESET"
        npm install --global "$@"
    fi
}

nu() {
    if [ "$(yarn-exists)" == "1" ]; then
        echo "$GREY$ yarn remove "$@"$RESET"
        yarn remove "$@"
    else
        echo "$GREY$ npm uninstall --save "$@"$RESET"
        npm uninstall --save "$@"
    fi
}

nud() {
    if [ "$(yarn-exists)" == "1" ]; then
        echo "$GREY$ yarn remove "$@"$RESET"
        yarn remove "$@"
    else
        echo "$GREY$ npm uninstall --save-dev "$@"$RESET"
        npm uninstall --save-dev "$@"
    fi
}

nug() {
    if [ "$(yarn-exists)" == "1" ]; then
        echo "$GREY$ yarn global remove "$@"$RESET"
        yarn global remove "$@"
    else
        echo "$GREY$ npm uninstall --global "$@"$RESET"
        npm uninstall --global "$@"
    fi
}

ns() {
    if [ "$(yarn-exists)" == "1" ]; then
        echo "$GREY$ yarn start "$@"$RESET"
        yarn start "$@"
    else
        echo "$GREY$ npm start "$@"$RESET"
        npm start "$@"
    fi
}

nt() {
    if [ "$(yarn-exists)" == "1" ]; then
        echo "$GREY$ yarn test "$@"$RESET"
        yarn test "$@"
    else
        echo "$GREY$ npm test "$@"$RESET"
        npm test "$@"
    fi
}

nl() {
    if [ "$(yarn-exists)" == "1" ]; then
        echo "$GREY$ yarn list --depth=0 "$@"$RESET"
        yarn list --depth=0 "$@"
    else
        echo "$GREY$ npm list --depth=0 "$@"$RESET"
        npm list --depth=0 "$@"
    fi
}

nlg() {
    if [ "$(yarn-exists)" == "1" ]; then
        echo "$GREY$ yarn global list --depth=0 "$@"$RESET"
        yarn global list --depth=0 "$@"
    else
        echo "$GREY$ npm list --global --depth=0 "$@"$RESET"
        npm list --global --depth=0 "$@"
    fi
}

nupgrade() {
    echo "upgrading npm..."
    curl http://npmjs.org/install.sh | sudo sh
}

nv() {
    if [ ! -z "$NVM_DIR" ]; then
        if [ "$(is_win)" == "yes" ]; then
            echo "nvm  v$(nvm version)"
        else
            echo "nvm  v$(nvm --version)"
        fi
    else
        echo "nvm [not installed]"
    fi
    if [ "$(type -P node)" ]; then
        echo "node $(node --version)"
    else
        echo "node [not installed]"
    fi
    if [ "$(type -P npm)" ]; then
        echo "npm  v$(npm --version)"
    else
        echo "npm  [not installed]"
    fi
    if [ "$(yarn-exists)" == "1" ]; then
        echo "yarn $(yarn --version)"
    else
        echo "yarn [not installed]"
    fi
}

ngp() {
    readlink -f "$(which ${1:-npm})"
}

if [ "$(is_win)" == "yes" ]; then
    alias npm="cmd /c npm"
fi

# vim: set tw=0:syn=sh :
